<!DOCTYPE html>
<!--
SEEK
Copyright (C) 2025 placelink

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.

=========================================================================

상업적 이용 또는 AGPL-3.0의 공개 의무를 면제받기
위해서는, placelink로부터 별도의 상업용 라이선스(Commercial License)를 구매해야 합니다.
For commercial use or to obtain an exemption from the AGPL-3.0 license
requirements, please purchase a commercial license from placelink.
*** 문의처: help@placelink.shop (README.md 참조)
-->
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{_layout/basic/layout}">
    <th:block layout:fragment="bodyStyle"></th:block>
    <th:block layout:fragment="bodyScript">
        <script type="module">
            import {S2Util} from '[[@{/public/js/s2.util.js}]]';

            window.initPage = () => {
                document.querySelectorAll('.btn-coming-soon')?.forEach((btn) => btn.addEventListener('click', () => S2Util.alert('준비 중입니다.')));
            };
        </script>
    </th:block>
    <th:block layout:fragment="bodyFragment">
        <div class="main-contents-contents">
            <div class="wrap-top">
                <h1>
                    <span class="main-title menu9">이상 패턴 탐지 현황</span>
                    <span class="sub-title">정상 업무 패턴을 벗어난 의심 행위 탐지</span>
                </h1>
            </div>
            <div class="wrap-contents">
                <div class="top">
                    <div class="c-flex-sty01 targetDate-wrap">
                        <div class="arrow-left"></div>
                        <div class="data-date">
                            <div class="date targetDate">0000년 00월 00일</div>
                            <div class="icon-today">TODAY</div>
                        </div>
                        <div class="arrow-right"></div>
                    </div>
                </div>
                <div class="contents">
                    <div class="status-card">
                        <div class="card type1 many-on-many white">
                            <div class="title-box menu6-1 padding-left-0">
                                <div class="card-title">전체 이상패턴 탐지 건수</div>
                                <div class="card-desc">PC별 이상패턴 탐지 합계</div>
                            </div>
                            <div class="card-content"><span th:text="${#numbers.formatDecimal(userIntegratedActivity.totalAnomalyCount, 0, 'COMMA', 0, 'POINT')}">0</span>건</div>
                        </div>
                        <div class="card type1 many-on-many white">
                            <div class="title-box menu6-2 padding-left-0">
                                <div class="card-title">위험 점수</div>
                                <div class="card-desc">이상 탐지 분석 등을 종합한 위험 지수</div>
                            </div>
                            <div class="card-content"><span th:text="${userIntegratedActivity.activityScore}">0</span>점</div>
                        </div>
                        <div class="card border"></div>
                        <div class="card type1 many-on-many mint">
                            <div class="title-box menu6-3">
                                <div class="card-title">정상</div>
                                <div class="card-desc">이상 탐지 정상 건수</div>
                            </div>
                            <div class="card-content"><span th:text="${#numbers.formatDecimal(userIntegratedActivity.normalCount, 0, 'COMMA', 0, 'POINT')}">0</span>건</div>
                        </div>
                        <div class="card type1 many-on-many tangerine">
                            <div class="title-box menu6-4">
                                <div class="card-title">점검</div>
                                <div class="card-desc">이상 패턴 점검 건수</div>
                            </div>
                            <div class="card-content"><span th:text="${#numbers.formatDecimal(userIntegratedActivity.inspectCount, 0, 'COMMA', 0, 'POINT')}">0</span>건</div>
                        </div>
                        <div class="card type1 many-on-many red">
                            <div class="title-box menu6-5">
                                <div class="card-title">경고</div>
                                <div class="card-desc">이상 패턴 경고 건수</div>
                            </div>
                            <div class="card-content"><span th:text="${#numbers.formatDecimal(userIntegratedActivity.warningCount, 0, 'COMMA', 0, 'POINT')}"></span>건</div>
                        </div>
                    </div>
                    <h2 class="type1">PC별 이상 패턴 탐지 현황</h2>
                    <div class="table-wrap type1 dark-gray multi-head">
                        <table class="table-sty01">
                            <caption>
                                PC별 이상 패턴 탐지 현황
                            </caption>
                            <thead>
                                <tr>
                                    <th rowspan="2" class="c-width-9p">사용자 ID</th>
                                    <th colspan="3">에이전트 중지 패턴</th>
                                    <th colspan="2">복호화 시도 패턴</th>
                                    <th colspan="3">외부 유출 시도 패턴</th>
                                    <th rowspan="2">탐지 결과</th>
                                    <th rowspan="2">알림 전송</th>
                                </tr>
                                <tr>
                                    <th class="c-width-9dot5p">반복 중지</th>
                                    <th class="c-width-9dot5p">업무시간대 중지</th>
                                    <th class="c-width-9dot5p">일부 프로세스 중지</th>
                                    <th class="c-width-9dot5p">비 업무시간대 복호화</th>
                                    <th class="c-width-9dot5p">대량 복호화</th>
                                    <th class="c-width-9dot5p">비 업무시간대 전송</th>
                                    <th class="c-width-9dot5p">중복 전송</th>
                                    <th class="c-width-9dot5p">대량 전송</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- 데이터가 없을 경우 -->
                                <tr th:if="${#lists.isEmpty(userIntegratedActivity.userActivityList)}">
                                    <td colspan="11" class="no-data">데이터가 없습니다.</td>
                                </tr>
                                <tr th:unless="${#lists.isEmpty(userIntegratedActivity.userActivityList)}" th:each="userActivity : ${userIntegratedActivity.userActivityList}">
                                    <td th:text="${userActivity.userId}"></td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.allFunctionalMaxDisconnectDurationStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.allFunctionalMaxDisconnectDurationStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.allFunctionalMaxDisconnectDurationStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.allFunctionalMaxBusinessDisconnectDurationStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.allFunctionalMaxBusinessDisconnectDurationStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.allFunctionalMaxBusinessDisconnectDurationStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.anyFunctionalMaxDisconnectDurationStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.anyFunctionalMaxDisconnectDurationStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.anyFunctionalMaxDisconnectDurationStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.unmaskNonBusinessCountStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.unmaskNonBusinessCountStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.unmaskNonBusinessCountStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.unmaskItemCountStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.unmaskItemCountStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.unmaskItemCountStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.fileOutboundNonBusinessTotalCountStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.fileOutboundNonBusinessTotalCountStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.fileOutboundNonBusinessTotalCountStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.fileOutboundMaxDuplicateFileCountStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.fileOutboundMaxDuplicateFileCountStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.fileOutboundMaxDuplicateFileCountStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td class="status-td">
                                        <div th:if="${userActivity.fileOutboundTotalCountStatus == @Constants.CD_STATUS_WARNING}" class="status-icon warning">경고</div>
                                        <div th:if="${userActivity.fileOutboundTotalCountStatus == @Constants.CD_STATUS_INSPECT}" class="status-icon inspect">점검</div>
                                        <div th:if="${userActivity.fileOutboundTotalCountStatus == @Constants.CD_STATUS_NORMAL}" class="status-icon normal">정상</div>
                                    </td>
                                    <td>
                                        <span th:if="${userActivity.highestStatus == @Constants.CD_STATUS_WARNING}" class="status warning">경고</span>
                                        <span th:if="${userActivity.highestStatus == @Constants.CD_STATUS_INSPECT}" class="status inspect">점검</span>
                                        <span th:if="${userActivity.highestStatus == @Constants.CD_STATUS_NORMAL}" class="status normal">정상</span>
                                    </td>
                                    <td>
                                        <button th:if="${userActivity.highestStatus == @Constants.CD_STATUS_INSPECT or userActivity.highestStatus == @Constants.CD_STATUS_WARNING}" class="table-btn-sty01 btn-coming-soon">전송</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <div class="pagination-wrapper"></div>
                    </div>
                </div>
            </div>
        </div>
    </th:block>
</html>
