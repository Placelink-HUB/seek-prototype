<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="biz.placelink.aicas.analysis.service.AnalysisParticipantsMapper">

	<insert id="insertAnalysisParticipants" parameterType="analysisParticipantsVO">
		/** insertAnalysisParticipants : 분석 대상자 정보를 등록한다. */
		INSERT INTO TB_ANALYSIS_PARTICIPANTS (
			PARTICIPANTS_ID,
			MANAGER_UID,
			NAME,
			BIRTH_DE,
			GENDER_CCD,
			MOBILE_NUMBER,
			POST_CODE,
			ADDRESS,
			ADDRESS_DETAIL,
			CREATE_DT,
			CREATE_UID,
			MODIFY_DT,
			MODIFY_UID
		) VALUES (
			#{participantsId},
			#{managerUid},
			#{name},
			#{birthDe},
			#{genderCcd},
			REGEXP_REPLACE(#{mobileNumber}, '[^0-9]', '', 'g'),
			#{postCode},
			#{address},
			#{addressDetail},
			NOW(),
			#{createUid},
			NOW(),
			#{createUid}
		)
	</insert>

	<update id="updateAnalysisParticipants" parameterType="analysisParticipantsVO">
		/** updateAnalysisParticipants : 분석 대상자 정보를 수정한다. */
		UPDATE TB_ANALYSIS_PARTICIPANTS
		SET
			MOBILE_NUMBER = REGEXP_REPLACE(#{mobileNumber}, '[^0-9]', '', 'g'),
			POST_CODE = #{postCode},
			ADDRESS = #{address},
			ADDRESS_DETAIL = #{addressDetail},
			MODIFY_DT = NOW(),
			MODIFY_UID = COALESCE(#{modifyUid}, #{createUid})
		WHERE PARTICIPANTS_ID = #{participantsId}
	</update>

</mapper>