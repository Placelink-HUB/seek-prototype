<?xml version="1.0" encoding="UTF-8"?>
<!--
SEEK
Copyright (C) 2025 placelink

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program. If not, see <https://www.gnu.org/licenses/>.

=========================================================================

상업적 이용 또는 AGPL-3.0의 공개 의무를 면제받기
위해서는, placelink로부터 별도의 상업용 라이선스(Commercial License)를 구매해야 합니다.
For commercial use or to obtain an exemption from the AGPL-3.0 license
requirements, please purchase a commercial license from placelink.
*** 문의처: help@placelink.shop (README.md 참조)
-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="common.sql">

	<sql id="orderBy">
        <if test='orderByList neq null and orderByList.size > 0'>
            <foreach collection="orderByList" item="orderBy" separator="," open="ORDER BY">
                <choose>
                    <when test='orderBy.column eq "CREATE_DT"'>
                        CREATE_DT
                    </when>
                    <when test='orderBy.column eq "MODIFY_DT"'>
                        MODIFY_DT
                    </when>
                    <when test='orderBy.column eq "REQUEST_DT"'>
                        REQUEST_DT
                    </when>
                    <when test='orderBy.column eq "LAST_REQUEST_DT"'>
                        LAST_REQUEST_DT
                    </when>
                    <when test='orderBy.column eq "EVENT_DT"'>
                        EVENT_DT
                    </when>
                    <when test='orderBy.column eq "LAST_EVENT_DT"'>
                        LAST_EVENT_DT
                    </when>

                    <!-- 기존 ORDER BY에 사용하지 않은 새로운 Column을 사용하는 경우 <otherwise> 앞에 <when>을 추가 -->
                    <otherwise>
                        #{orderBy.column}
                    </otherwise>
                </choose>
                <choose>
                    <when test='orderBy.sort neq null and orderBy.sort eq "DESC"'>
                        DESC
                    </when>
                    <otherwise>
                        ASC
                    </otherwise>
                </choose>
            </foreach>
        </if>
	</sql>

	<sql id="paging_header">
		SELECT pg_wp.*
		FROM (
	</sql>

	<sql id="paging_footer">
		) pg_wp
		<include refid="common.sql.orderBy"/>
		<if test='pagingYn eq null or pagingYn neq "N"'>
            LIMIT #{pageUnit} OFFSET #{firstIndex}
		</if>
	</sql>


</mapper>
